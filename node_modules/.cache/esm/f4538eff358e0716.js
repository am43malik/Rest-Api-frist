let Custumerrorhandler,jsonwebservise;_358‍.x([["default",()=>_358‍.o]]);_358‍.w("../error/CustumErrorhandler",[["default",["Custumerrorhandler"],function(v){Custumerrorhandler=v}]]);_358‍.w("../error/jsonwebtoken",[["default",["jsonwebservise"],function(v){jsonwebservise=v}]]);


const userauth =async (req, res, next) => {
  let auth = req.headers.authorization;
//   console.log(auth);

  if (!auth) {
    return next(Custumerrorhandler.unAuthorized());
  }

  const token = auth.split(' ')[1];


  try {
    const { id, role } = await jsonwebservise.verify(token);

    let user = {
      id, role,
    };

    req.user = user;
    
    next();
  } catch (err) {
    return next(err);
  }
};

_358‍.d(userauth);
